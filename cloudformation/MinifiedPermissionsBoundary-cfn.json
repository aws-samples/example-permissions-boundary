{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "Defines a reasonable starting point for a basic permission boundary policy - allow list of services used by custom application roles",
  "Resources" : {
    "MinifiedPermissionBoundary" : {
      "Type": "AWS::IAM::ManagedPolicy",
      "Properties": {
        "Path": "/",
        "ManagedPolicyName":"MinifiedPermissionsBoundary",
        "PolicyDocument" :{
          "Version": "2012-10-17",
          "Statement": [
              {
                  "Effect": "Allow",
                  "Action": [
                      "acm-pca:GetCertificate",
                      "acm-pca:GetCertificateAuthorityCe*",
                      "acm-pca:ListC*",
                      "acm:GetC*",
                      "acm:ListC*",
                      "appsync:*",
                      "athena:B*",
                      "athena:CreateN*",
                      "athena:DeleteN*",
                      "athena:G*",
                      "athena:L*",
                      "athena:S*",
                      "batch:Ca*",
                      "batch:DescribeJobQ*",
                      "batch:DescribeJobs",
                      "batch:ListJ*",
                      "batch:S*",
                      "batch:Te*",
                      "cloudformation:DescribeStacks",
                      "cloudwatch:PutMetricD*",
                      "cloudwatch:PutMetricS*",
                      "codedeploy-commands-secure:*",
                      "codepipeline:ListPipelineE*",
                      "codepipeline:PutJ*",
                      "comprehend:*",
                      "dynamodb:B*",
                      "dynamodb:Co*",
                      "dynamodb:DeleteI*",
                      "dynamodb:DescribeS*",
                      "dynamodb:DescribeTable",
                      "dynamodb:G*",
                      "dynamodb:ListG*",
                      "dynamodb:ListS*",
                      "dynamodb:ListT*",
                      "dynamodb:Pa*",
                      "dynamodb:Put*",
                      "dynamodb:Q*",
                      "dynamodb:Sc*",
                      "dynamodb:UpdateI*",
                      "ec2:Des*",
                      "ecr:BatchGetI*",
                      "ecr:DescribeImages",
                      "ecr:GetA*",
                      "ecr:GetD*",
                      "ecr:ListI*",
                      "ecs:Ru*",
                      "elasticfilesystem:Cl*",
                      "elasticmapreduce:AddJ*",
                      "elasticmapreduce:Ca*",
                      "elasticmapreduce:ListInstanceF*",
                      "elasticmapreduce:ListInstanceG*",
                      "elasticmapreduce:ModifyI*",
                      "elasticmapreduce:Se*",
                      "elasticmapreduce:T*",
                      "es:ESH*",
                      "events:ListEventB*",
                      "events:PutE*",
                      "events:PutPa*",
                      "execute-api:*",
                      "firehose:*",
                      "forecast:*",
                      "frauddetector:*",
                      "geo:*",
                      "glue:*",
                      "kafka-cluster:AlterG*",
                      "kafka-cluster:AlterTopic",
                      "kafka-cluster:AlterTr*",
                      "kafka-cluster:Co*",
                      "kafka-cluster:Des*",
                      "kafka-cluster:R*",
                      "kafka-cluster:W*",
                      "kendra:*",
                      "kinesis:*",
                      "kms:Dec*",
                      "kms:Enc*",
                      "kms:GenerateD*",
                      "kms:GenerateR*",
                      "kms:ListA*",
                      "kms:ListKeys",
                      "kms:ReE*",
                      "kms:Si*",
                      "kms:Verify",
                      "lambda:InvokeA*",
                      "lambda:InvokeFunction",
                      "lex:*",
                      "logs:CreateLogG*",
                      "logs:CreateLogS*",
                      "logs:Des*",
                      "logs:F*",
                      "logs:L*",
                      "logs:PutL*",
                      "mobileanalytics:P*",
                      "mobiletargeting:*",
                      "neptune-db:*",
                      "personalize:*",
                      "polly:*",
                      "rds-db:*",
                      "redshift:GetC*",
                      "rekognition:*",
                      "s3:A*",
                      "s3:CreateJ*",
                      "s3:DeleteJ*",
                      "s3:DeleteO*",
                      "s3:DeleteStorageLensConfigurationT*",
                      "s3:DescribeJ*",
                      "s3:GetBucketLoc*",
                      "s3:GetE*",
                      "s3:GetL*",
                      "s3:GetObject",
                      "s3:GetObjectAc*",
                      "s3:GetObjectT*",
                      "s3:GetObjectVersion",
                      "s3:GetObjectVersionAc*",
                      "s3:GetObjectVersionF*",
                      "s3:GetObjectVersionT*",
                      "s3:L*",
                      "s3:PutBucketT*",
                      "s3:PutJ*",
                      "s3:PutL*",
                      "s3:PutObject",
                      "s3:PutObjectA*",
                      "s3:PutObjectT*",
                      "s3:PutObjectVersionT*",
                      "s3:PutStorageLensConfigurationT*",
                      "s3:ReplicateO*",
                      "s3:ReplicateT*",
                      "s3:Res*",
                      "s3:U*",
                      "secretsmanager:Ca*",
                      "secretsmanager:Des*",
                      "secretsmanager:GetRa*",
                      "secretsmanager:GetS*",
                      "secretsmanager:L*",
                      "secretsmanager:PutS*",
                      "secretsmanager:Res*",
                      "secretsmanager:Ro*",
                      "secretsmanager:Up*",
                      "ses:CreateCu*",
                      "ses:CreateEmailT*",
                      "ses:CreateT*",
                      "ses:DeleteCu*",
                      "ses:DeleteEmailT*",
                      "ses:DeleteT*",
                      "ses:GetCu*",
                      "ses:GetEmailT*",
                      "ses:GetIdentityV*",
                      "ses:GetT*",
                      "ses:ListCu*",
                      "ses:ListEmailT*",
                      "ses:ListTe*",
                      "ses:Sen*",
                      "ses:Te*",
                      "ses:UpdateCu*",
                      "ses:UpdateEmailT*",
                      "ses:UpdateT*",
                      "ses:VerifyEmailI*",
                      "sns:CreateT*",
                      "sns:ListSubscriptionsB*",
                      "sns:ListTo*",
                      "sns:P*",
                      "sns:SetT*",
                      "sns:Su*",
                      "sqs:Ch*",
                      "sqs:DeleteM*",
                      "sqs:G*",
                      "sqs:ListQueues",
                      "sqs:P*",
                      "sqs:Rec*",
                      "sqs:Sen*",
                      "ssm:DescribePar*",
                      "ssm:GetPar*",
                      "ssm:PutP*",
                      "ssmmessages:*",
                      "states:DescribeA*",
                      "states:DescribeE*",
                      "states:GetA*",
                      "states:ListA*",
                      "states:ListE*",
                      "states:ListS*",
                      "states:S*",
                      "swf:*",
                      "textract:*",
                      "timestream:Ca*",
                      "timestream:ListD*",
                      "timestream:ListTab*",
                      "timestream:S*",
                      "timestream:W*",
                      "transcribe:*",
                      "translate:*",
                      "xray:PutT*"
                  ],
                  "Resource": "*"
              }
          ]
      }
    }
    }
  },
  "Outputs" : {
    "MinifiedPermissionBoundaryARN" : {
      "Description" : "ARN of the Minified Reference Permission Boundary policy",
      "Value" : { "Ref" : "MinifiedPermissionBoundary" },
      "Export" : {
        "Name" : "MinifiedPermissionBoundaryARN"
      }
    }
  }
}
  